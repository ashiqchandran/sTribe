<%- include("../partials/admin/header") %>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Details</title>
  <style>
    :root {
      --primary-color: #1a73e8;
      --secondary-color: #f5f7fa;
      --text-color: #202124;
      --border-color: #dcdcdc;
      --success-color: #34a853;
      --pending-color: #f9ab00;
      --processing-color: #4285f4;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --error-color: #ea4335;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }



    h1 {
      color: var(--primary-color);
      font-size: 2.2rem;
      text-align: center;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .order-container {
      background-color: #fff;
      max-width: 1000px;
      margin: 0 auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: var(--shadow);
    }

    .product-details {
      display: flex;
      gap: 30px;
      margin-bottom: 40px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 20px;
    }

    .product-image img {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }

    .product-info {
      flex: 1;
    }

    .product-info h2 {
      font-size: 1.6rem;
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .product-info .price {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--text-color);
      margin-bottom: 10px;
    }

    .product-info .stars {
      color: #f9ab00;
      font-size: 1.2rem;
      margin-bottom: 15px;
    }

    .product-info p {
      font-size: 1rem;
      color: var(--text-color);
      margin-bottom: 10px;
    }

    .order-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .order-info p {
      font-size: 1rem;
    }

    .order-info strong {
      font-weight: 600;
      color: var(--primary-color);
    }

    .back-btn {
      display: block;
      text-align: center;
      margin-top: 20px;
      padding: 10px 20px;
      background-color: var(--primary-color);
      color: #fff;
      border-radius: 6px;
      text-decoration: none;
      font-size: 1rem;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .back-btn:hover {
      background-color: #1557b0;
      transform: translateY(-2px);
    }

    .error {
      color: var(--error-color);
      text-align: center;
      font-size: 1.2rem;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      h1 { font-size: 1.8rem; }
      .order-container { padding: 20px; }
      .product-details { flex-direction: column; }
      .product-image img { width: 100%; max-width: 300px; height: auto; }
      .product-info h2 { font-size: 1.4rem; }
      .product-info .price { font-size: 1.2rem; }
    }

    @media (max-width: 480px) {
      .order-info { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <h1>Order Details</h1>

  <div class="order-container">
    <% if (order) { %>
      <!-- Product Details -->
      <div class="product-details">
        <div class="product-image">
          <img src="<%= order.orderItems[0].orderProductImage && order.orderItems[0].orderProductImage[0] ? order.orderItems[0].orderProductImage[0] : 'https://via.placeholder.com/200' %>" alt="<%= order.orderItems[0].OrderProductName || 'Product' %>">
        </div>
        <div class="order-horizontal" style="display: flex
        
        ;">
          <div class="product-info">
            <h2><%= product.productName || 'N/A' %></h2>
            <div class="price">₹ <%= order.totalPrice ? order.totalPrice.toLocaleString('en-IN') : '0' %></div>
            <div class="stars">
              <%= product.ratting ? '★'.repeat(product.ratting) : 'No Rating' %>
            </div>
            
            <p><strong>Category:</strong> <%= category.name%></p> <!-- Add category field to schema if needed -->
            <p><strong>Color:</strong> <%= order.orderItems[0].color || 'N/A' %></p>
            <p><strong>Quantity:</strong> <%= order.orderItems[0].quantity || 1 %></p>
          </div>
          <div>
            <button class="product-order" onclick="orderProductDetail('<%= order._id %>')">View In Detail</button>
          </div>

        </div>
       
      </div>

      <!-- Order Info -->
      <div class="order-info">
        <p><strong>Order ID:</strong> <%= order.orderId %></p>
        <p><strong>Order Date:</strong> <%= order.orderDate %></p>
        <p><strong>Customer Name:</strong> <%= order.address.name  %></p>
        <p><strong>Email:</strong> <%= order.customerEmail %></p>
        <p><strong>Address:</strong> <%= order.address.streetAddress + ', ' + order.address.city + ', ' + order.address.state + ', ' + order.address.country + ' - ' + order.address.pincode %></p>
        <p><strong>Payment Method:</strong> <%= order.transactionId ? 'Online (Transaction ID: ' + order.transactionId + ')' : 'N/A' %></p>
        <p><strong>Total Amount:</strong> ₹ <%= order.finalAmount ? order.finalAmount.toLocaleString('en-IN') : '0' %></p>
      </div>

      <!-- Back Button -->
      <a href="/admin/transaction" class="back-btn">Back to Transactions</a>
    <% } else { %>
      <p class="error">Order not found</p>
    <% } %>
  </div>
  <script>
    function orderProductDetail(id){
      window.location.href=`/admin/orders/${id}`
    }
  </script>
</body>
</html>