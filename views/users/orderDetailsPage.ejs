<%- include("../partials/admin/header") %>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Details</title>
  <style>
    :root {
      --primary-color: #1a73e8; /* Blue */
      --secondary-color: #f5f7fa; /* Light gray background */
      --text-color: #202124; /* Dark gray text */
      --border-color: #dcdcdc; /* Light border */
      --success-color: #34a853; /* Green for delivered */
      --pending-color: #f9ab00; /* Yellow for dispatched */
      --processing-color: #4285f4; /* Blue for shipped */
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --error-color: #ea4335; /* Red for errors */
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--secondary-color);
      color: var(--text-color);
      padding: 20px;
      line-height: 1.6;
    }

    h1 {
      color: var(--primary-color);
      font-size: 2.2rem;
      text-align: center;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .order-container {
      background-color: #fff;
      max-width: 1000px;
      margin: 0 auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: var(--shadow);
    }

    /* Status Bar */
    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      position: relative;
    }

    .status-bar::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      height: 4px;
      background-color: var(--border-color);
      z-index: 0;
    }

    .status-step {
      flex: 1;
      text-align: center;
      position: relative;
      z-index: 1;
    }

    .status-circle {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background-color: var(--border-color);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 10px;
      transition: background-color 0.3s ease;
    }

    .status-step.active .status-circle {
      background-color: var(--processing-color); /* Default for active */
    }

    .status-step.completed .status-circle {
      background-color: var(--success-color);
    }

    .status-step.pending .status-circle {
      background-color: var(--pending-color);
    }

    .status-label {
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .status-bar .active ~ .status-step .status-circle {
      background-color: var(--border-color); /* Inactive steps after active */
    }

    /* Product Details */
    .product-details {
      display: flex;
      gap: 30px;
      margin-bottom: 40px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 20px;
    }

    .product-image img {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }

    .product-info {
      flex: 1;
    }

    .product-info h2 {
      font-size: 1.6rem;
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .product-info .price {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--text-color);
      margin-bottom: 10px;
    }

    .product-info .stars {
      color: #f9ab00;
      font-size: 1.2rem;
      margin-bottom: 15px;
    }

    .product-info p {
      font-size: 1rem;
      color: var(--text-color);
      margin-bottom: 10px;
    }

    /* Order Info */
    .order-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .order-info p {
      font-size: 1rem;
    }

    .order-info strong {
      font-weight: 600;
      color: var(--primary-color);
    }

    /* Error Message */
    .error {
      color: var(--error-color);
      text-align: center;
      font-size: 1.2rem;
      margin-top: 20px;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      h1 { font-size: 1.8rem; }
      .order-container { padding: 20px; }
      .product-details { flex-direction: column; }
      .product-image img { width: 100%; max-width: 300px; height: auto; }
      .status-circle { width: 25px; height: 25px; font-size: 0.9rem; }
      .status-label { font-size: 0.8rem; }
      .product-info h2 { font-size: 1.4rem; }
      .product-info .price { font-size: 1.2rem; }
    }

    @media (max-width: 480px) {
      .status-bar { flex-direction: column; gap: 20px; }
      .status-bar::before { display: none; }
      .status-step { flex: none; }
      .order-info { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <h1>Order Details</h1>

  <div class="order-container">
    <% if (order) { %>
      <!-- Status Bar -->
      <div class="status-bar">
        <div class="status-step <%= order.status === 'Ordered' ? 'active' : 'completed' %>">
          <span class="status-circle">1</span>
          <div class="status-label">Ordered</div>
        </div>
        <div class="status-step <%= order.status === 'Shipped' ? 'active' : (order.status === 'Dispatched' || order.status === 'Delivered') ? 'completed' : '' %>">
          <span class="status-circle">2</span>
          <div class="status-label">Shipped</div>
        </div>
        <div class="status-step <%= order.status === 'Dispatched' ? 'active' : order.status === 'Delivered' ? 'completed' : 'pending' %>">
          <span class="status-circle">3</span>
          <div class="status-label">Dispatched</div>
        </div>
        <div class="status-step <%= order.status === 'Delivered' ? 'active completed' : 'pending' %>">
          <span class="status-circle">4</span>
          <div class="status-label">Delivered</div>
        </div>
      </div>

      <!-- Product Details -->
      <div class="product-details">
        <div class="product-image">
          <img src="<%= order.productImage || 'https://via.placeholder.com/200' %>" alt="Product Image">
        </div>
        <div class="product-info">
          <h2><%= order.productName || 'Product Name' %></h2>
          <div class="price">₹ <%= order.price ? order.price.toLocaleString('en-IN') : '0' %></div>
          <div class="stars">
            <% for(let i = 0; i < 5; i++) { %>
              <span><%= i < (order.rating || 4) ? '★' : '☆' %></span>
            <% } %>
          </div>
          <p><strong>Category:</strong> <%= order.category || 'N/A' %></p>
          <p><strong>Brand:</strong> <%= order.brand || 'N/A' %></p>
          <p><strong>Quantity:</strong> <%= order.quantity || 1 %></p>
        </div>
      </div>

      <!-- Order Info -->
      <div class="order-info">
        <p><strong>Order ID:</strong> <%= order._id %></p>
        <p><strong>Order Date:</strong> <%= new Date(order.date).toLocaleString() %></p>
        <p><strong>Customer Name:</strong> <%= order.customerName || 'John Doe' %></p>
        <p><strong>Email:</strong> <%= order.customerEmail || 'john.doe@example.com' %></p>
        <p><strong>Shipping Address:</strong> <%= order.shippingAddress || '123 Main St, City, Country' %></p>
        <p><strong>Payment Method:</strong> <%= order.paymentMethod || 'Razorpay' %></p>
        <p><strong>Total Amount:</strong> ₹ <%= order.totalAmount ? order.totalAmount.toLocaleString('en-IN') : order.price %></p>
      </div>
    <% } else { %>
      <p class="error"><%= error || 'Order not found' %></p>
    <% } %>
  </div>
</body>
</html>